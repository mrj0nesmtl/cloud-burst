---
description: Security Standards for Cloud Capture
globs: src/**/*.{ts,tsx}, middleware.ts
---
# Security Standards

## Security Configuration
```typescript
{
  "securityStandards": {
    "authentication": {
      "supabase": {
        "providers": ["google", "apple"],
        "session": {
          "persistence": true,
          "refreshInterval": 60 * 60 * 1000
        }
      },
      "routes": {
        "protected": [
          "/dashboard",
          "/events/[id]",
          "/admin"
        ],
        "public": [
          "/",
          "/auth",
          "/event/[code]"
        ]
      }
    },
    "authorization": {
      "roles": {
        "ADMIN": "Full system access",
        "EVENT_HOST": "Event management access",
        "USER": "Basic authenticated access",
        "GUEST": "Limited event access"
      },
      "permissions": {
        "photos": {
          "upload": ["USER", "GUEST"],
          "moderate": ["EVENT_HOST", "ADMIN"],
          "delete": ["EVENT_HOST", "ADMIN"]
        }
      }
    },
    "data": {
      "encryption": {
        "inTransit": "TLS 1.3",
        "atRest": "AES-256"
      },
      "sanitization": {
        "input": "src/lib/security/sanitize.ts",
        "output": "src/lib/security/escape.ts"
      }
    },
    "csrf": {
      "enabled": true,
      "excludePaths": ["/api/webhooks"]
    },
    "headers": {
      "security": {
        "X-Frame-Options": "DENY",
        "X-Content-Type-Options": "nosniff",
        "Strict-Transport-Security": "max-age=31536000; includeSubDomains",
        "Content-Security-Policy": "default-src 'self'"
      }
    }
  }
}
```